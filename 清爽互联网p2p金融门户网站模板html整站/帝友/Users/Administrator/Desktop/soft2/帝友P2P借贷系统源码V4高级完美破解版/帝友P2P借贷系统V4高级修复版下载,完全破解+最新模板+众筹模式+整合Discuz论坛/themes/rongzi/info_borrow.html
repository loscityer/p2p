{articles module="rating" function="GetInfoOne" user_id="$_G.user_id" var="var"}
<div style="padding:20px 80px" id="li_list_detail_1">
{articles module="credit" function="GetCreditCount" var="cvar" user_id=$_G.user_id}
{if $cvar.info_credit!=0 && $cvar.work_credit!=0 && $cvar.finance_credit!=0}
	{if $_G.site_result.nid=="amount_info"}
	<div style="font-size:12px;float:right;">恭喜您，已填写完成基本信息。<a href="/amount_att/index.html" style="color:#0000ff;">点击此处进入下一步</a>。</div>
	{/if}
{/if}
{/articles}
<table width="100%"  border="0" cellpadding="0" cellspacing="0" class="jk_tab">
  <form action="/?user&q=code/rating/info" method="post" name="formx" id="formx" onsubmit="return check();">
  <tr>
    <td width="24%" align="right"><span>*</span>真实姓名：</td>
    <td width="76%" align="left"><input type="text" name="realname" id="realname" value="{$var.realname}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>身份证号：</td>
    <td width="76%" align="left"><input type="text" name="card_id" id="card_id" value="{$var.card_id}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>手机号码：</td>
    <td width="76%" align="left"><input type="text" name="phone_num" id="phone_num" value="{$var.phone_num}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>性别：</td>
    <td width="76%" align="left">{linkages nid="rating_sex" name="sex" value="$var.sex" type="value"  style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>出生日期：</td>
    <td width="76%" align="left"><input type="text" name="birthday" id="birthday" value="{$var.birthday}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>最高学历：</td>
    <td width="76%" align="left">{linkages nid="rating_education" name="edu" value="$var.edu" type="value" style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>入学年份：</td>
    <td width="76%" align="left"><input type="text" name="school_year" id="school_year" value="{$var.school_year}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>毕业院校：</td>
    <td width="76%" align="left"><input type="text" name="school" id="school" value="{$var.school}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>婚姻状况：</td>
    <td width="76%" align="left">{linkages nid="rating_marry" name="marry" type="value" value="$var.marry"  style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>有无子女：</td>
    <td width="76%" align="left">{linkages nid="rating_children" name="children" value="$var.children" type="value"  style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>是否有房：</td>
    <td width="76%" align="left">{linkages nid="rating_house" name="house" value="$var.house" type="value"  style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>是否有车：</td>
    <td width="76%" align="left">{linkages nid="rating_car" name="is_car" value="$var.is_car" type="value"  style="width:150px; border:#BFBFBF solid 1px; height:18px;"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>户口所在地：</td>
    <td width="76%" align="left">{areas type="p,c" value="$var.city"}</td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>*</span>居住地址：</td>
    <td width="76%" align="left"><input type="text" name="address" id="address" value="{$var.address}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td width="24%" align="right"><span>&nbsp;</span>居住电话：</td>
    <td width="76%" align="left"><input type="text" name="phone" id="phone"  value="{$var.phone}" style="width:150px; border:#BFBFBF solid 1px; height:18px;"/></td>
  </tr>
  <tr>
    <td>&nbsp;{if $_G.site_result.nid=="amount_info"}<input type="hidden" name="web" value="amount">{elseif $_G.site_result.nid=="borrow_info"}<input type="hidden" name="web" value="borrow">{/if}</td>
    <td><input type="submit" name="submit" value="提交并继续" onclick="return isIdCardNo(document.forms['formx'].elements['card_id'].value)" class="btn1" /> <span>*</span>为必填项</td>
  </tr>
  </form>
</table>
</div>
{/articles}
<script>
var realname_status={$_G.userinfo.realname_status|default:0};
{literal}
function check(){
	 var frm = document.forms['formx'];
	 var realname = frm.elements['realname'].value;
	 var card_id = frm.elements['card_id'].value;
	 var phone_num = frm.elements['phone_num'].value;
	 var birthday = frm.elements['birthday'].value;
	 var school_year = frm.elements['school_year'].value;
	 var school = frm.elements['school'].value;
	 var address = frm.elements['address'].value;
	 var errorMsg = '';
	  if (realname.length == 0 ) {
		errorMsg += '* 真实姓名不能为空' + '\n';
	  }
	  if (card_id.length == 0 ) {
		errorMsg += '* 身份证号不能为空' + '\n';
	  }
	  if (phone_num.length == 0 ) {
		errorMsg += '* 手机号码不能为空' + '\n';
	  }
	  if (birthday.length == 0 ) {
		errorMsg += '* 出生日期不能为空' + '\n';
	  }
	  if (school_year.length == 0 ) {
		errorMsg += '* 入学年份不能为空' + '\n';
	  }
	  if (school.length == 0 ) {
		errorMsg += '* 毕业院校不能为空' + '\n';
	  }
	  if (address.length == 0 ) {
		errorMsg += '* 居住地址不能为空' + '\n';
	  }
	  if (errorMsg.length > 0){
		alert(errorMsg); return false;
	  } else{  
		return true;
	  }
}


function isIdCardNo(num) 
{   
          num = num.toUpperCase();  
         //身份证号码为15位或者18位，15位时全为数字，18位前17位为数字，最后一位是校验位，可能为数字或字符X。   
          if (!(/(^\d{15}$)|(^\d{17}([0-9]|X)$)/.test(num)))   
          { 
               alert('输入的身份证号长度不对，或者号码不符合规定！\n15位号码应全为数字，18位号码末位可以为数字或X。'); 
              return false; 
         } 
//校验位按照ISO 7064:1983.MOD 11-2的规定生成，X可以认为是数字10。 
//下面分别分析出生日期和校验位 
var len, re; 
len = num.length; 
if (len == 15) 
{ 
re = new RegExp(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/); 
var arrSplit = num.match(re); 

//检查生日日期是否正确 
var dtmBirth = new Date('19' + arrSplit[2] + '/' + arrSplit[3] + '/' + arrSplit[4]); 
var bGoodDay; 
bGoodDay = (dtmBirth.getYear() == Number(arrSplit[2])) && ((dtmBirth.getMonth() + 1) == Number(arrSplit[3])) && (dtmBirth.getDate() == Number(arrSplit[4])); 
if (!bGoodDay) 
{ 
          alert('输入的身份证号里出生日期不对！');   
           return false; 
} 
else 
{ 
//将15位身份证转成18位 
//校验位按照ISO 7064:1983.MOD 11-2的规定生成，X可以认为是数字10。 
          var arrInt = new Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2); 
           var arrCh = new Array('1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'); 
           var nTemp = 0, i;   
            num = num.substr(0, 6) + '19' + num.substr(6, num.length - 6); 
           for(i = 0; i < 17; i ++) 
          { 
                nTemp += num.substr(i, 1) * arrInt[i]; 
           } 
           num += arrCh[nTemp % 11];   
            return num;   
}   
} 
if (len == 18) 
{ 
re = new RegExp(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/); 
var arrSplit = num.match(re); 

//检查生日日期是否正确 
var dtmBirth = new Date(arrSplit[2] + "/" + arrSplit[3] + "/" + arrSplit[4]); 
var bGoodDay; 
bGoodDay = (dtmBirth.getFullYear() == Number(arrSplit[2])) && ((dtmBirth.getMonth() + 1) == Number(arrSplit[3])) && (dtmBirth.getDate() == Number(arrSplit[4])); 
if (!bGoodDay) 
{ 
alert(dtmBirth.getYear()); 
alert(arrSplit[2]); 
alert('输入的身份证号里出生日期不对！'); 
return false; 
} 
else 
{ 
//检验18位身份证的校验码是否正确。 
//校验位按照ISO 7064:1983.MOD 11-2的规定生成，X可以认为是数字10。 
var valnum; 
var arrInt = new Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2); 
var arrCh = new Array('1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'); 
var nTemp = 0, i; 
for(i = 0; i < 17; i ++) 
{ 
nTemp += num.substr(i, 1) * arrInt[i]; 
} 
valnum = arrCh[nTemp % 11]; 
if (valnum != num.substr(17, 1)) 
{ 
alert('输入身份证号不是有效证件！'); 
return false; 
} 
return num; 
} 
} 
return false; 
}
</script>
{/literal}