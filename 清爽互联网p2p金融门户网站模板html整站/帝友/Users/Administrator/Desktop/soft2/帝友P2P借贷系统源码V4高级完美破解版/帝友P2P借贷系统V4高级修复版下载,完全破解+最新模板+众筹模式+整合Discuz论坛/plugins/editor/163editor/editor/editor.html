<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<SCRIPT LANGUAGE="JAVASCRIPT" SRC="script/colorSelect.js"></SCRIPT>
<SCRIPT LANGUAGE="JAVASCRIPT" SRC="script/portraitSelect.js"></SCRIPT>

<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>多媒体编辑器</title>
<style type="text/css">
a {font-size:12px;}
img {border:0;}
td.icon {width:24px;height:24px;text-align:center;vertical-align:middle;}
td.sp {width:8px;height:24px;text-align:center;vertical-align:middle;}
td.xz {width:47px;height:24px;text-align:center;vertical-align:middle;}
td.bq {width:49px;height:24px;text-align:center;vertical-align:middle;}
div a.n {height:16px; line-height:16px; display:block; padding:2px; color:#000000; text-decoration:none;}
div a.n:hover {background:#E5E5E5;}
</style>
<style>
#magicface{}
#magicface td{ height:29px; width:29px; background-color:#F8F8F8; text-align:center;}
#magicface td onmouseover{background-Color:#FFcccc;} 
.mf_nowchose{ height:30px; background-color:#DFDFDF;border:1px solid #B5B5B5; border-left:none;}
.mf_other{ height:30px;border-left:1px solid #B5B5B5; }
.mf_otherdiv{ height:30px; width:30px;border:1px solid #FFF; border-right-color:#D6D6D6; border-bottom-color:#D6D6D6; background-color:#F8F8F8;}
.mf_otherdiv2{ height:30px; width:30px;border:1px solid #B5B5B5; border-left:none; border-top:none;}
.mf_link{ font-size:12px; color:#000000; text-decoration:none;}
.mf_link:hover{ font-size:12px; color:#000000; text-decoration:underline;}

</style>
<style type="text/css">
<!--
.ico {	height: 24px;	width: 24px; vertical-align:middle; text-align:center;
}
.ico2 {	height: 24px;	width: 27px; vertical-align:middle; text-align:center;
}
.ico3 {	height: 24px;	width: 25px; vertical-align:middle; text-align:center;
}
.ico4 {	height: 24px;	width: 8px; vertical-align:middle; text-align:center;
}
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
.icons{ width:20px; height:20px; background-image:url(images/mtoolallbg.gif); background-repeat:no-repeat; margin-top:2px}
.icoCut{ background-position:0 0}.icoCpy{ background-position:-28px 0}.icoPse{ background-position:-56px 0}.icoFfm{ background-position:-82px 0}.icoFsz{ background-position:-110px 0}.icoWgt{ background-position:-140px 0}.icoIta{ background-position:-168px 0}.icoUln{ background-position:-196px 0}.icoAgn{ background-position:-224px 0}.icoLst{ background-position:-252px 0}.icoLst{ background-position:-252px 0}.icoOdt{ background-position:-280px 0}.icoIdt{ background-position:-308px 0}.icoFcl{ background-position:-335px 0}.icoBcl{ background-position:-362px 0}.icoUrl{ background-position:-392px 0}.icoImg{ background-position:-420px 0}.icoMfc{ background-position:-447px 0}
-->
</style>
<SCRIPT LANGUAGE="JavaScript">
<!--
	function fontname(obj){
		format('fontname',obj.innerHTML);
		obj.parentNode.style.display='none';
	}
	function fontsize(size,obj){
		format('fontsize',size);
		obj.parentNode.style.display='none';
	}
//-->
LoadContent(Request('id'));
var gSetColorType = ""; 
var gIsIE = document.all; 
var gIEVer = fGetIEVer();
var gLoaded = false;
var ev = null;
function fGetEv(e){
	ev = e;
}
function ResetDomain()
{	
	var f = window.frames["HtmlEditor"];
	var ss=document.domain;						//ss == "www.126.com";
	var ii=ss.lastIndexOf('.');
	if(ii>0)
	{	if(!isNaN(ss.substr(ii+1)*1))
			return;
		ii=ss.lastIndexOf('.',ii-1);
		if(ii>0){
			f.document.domain = ss.substr(ii+1);
			document.domain	=ss.substr(ii+1);
		}
	}											//document.domain == "126.com";
}
function fGetIEVer(){
	var iVerNo = 0;
	var sVer = navigator.userAgent;
	if(sVer.indexOf("MSIE")>-1){
		var sVerNo = sVer.split(";")[1];
		sVerNo = sVerNo.replace("MSIE","");
		iVerNo = parseFloat(sVerNo);
	}
	return iVerNo;
}
function fSetEditable(){
	var f = window.frames["HtmlEditor"];
	f.document.designMode="on";
	if(!gIsIE)
		f.document.execCommand("useCSS",false, true);
}
function fSetFrmClick(){
	var f = window.frames["HtmlEditor"];
	f.document.onmousemove = function(){
		window.onblur();
	}
	f.document.onclick = function(){
		fHideMenu();
	}
	f.document.onkeydown = function(){
		top.frames["jsFrame"].gIsEdited = true;
	}
}
function fSetHtmlContent(){
	try{
		var f = window.frames["HtmlEditor"];
		var CM = window.parent.parent.parent.frames["jsFrame"].CM;
		var GE = window.parent.parent.parent.frames["jsFrame"].GE;
		win = window.parent.parent.parent.frames["jsFrame"];
		if(!GE.IsIE){
			try{
				if(!CM["compose"].htext){
					return;
				}
				if(CM["compose"].htext.trim() != ""){
					f.document.getElementsByTagName("body")[0].innerHTML = CM["compose"].htext;
					window.parent.parent.parent.status = "完成.";
				}
			}catch(e){
				window.setTimeout("fSetHtmlContent()",1500);
			}
		}else{
			if(GE.composeType == "reply" || GE.composeType == "forwardByCompose"){
				if(win.gReplyContent){
					window.setTimeout('fSetReplyContent()',500);
				}else{
					return;
				}
			}else if(GE.composeType == "draft" || GE.composeType == "photo" || GE.composeType == "netfolder"){
			
			}else{
				window.setTimeout('fSetSign()',500);
			}
			// f.focus();
		}
	}catch(exp){
		
	}
}
function fSetReplyContent(){
	try{
		win.fSetComposeContent(win.gReplyContent);
		window.frames["HtmlEditor"].focus()
	}catch(exp){
		window.setTimeout('fSetReplyContent()',1000);
	}
	win.gReplyContent = null;
}
function fSetSign(){
	var f = window.frames["HtmlEditor"];
	var CM = window.parent.parent.parent.frames["jsFrame"].CM;
	var GE = window.parent.parent.parent.frames["jsFrame"].GE;
	win = window.parent.parent.parent.frames["jsFrame"];
	f.document.body.innerHTML += "<div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;</div><div ID=\"spnSign\"></div>";
	spnSign = f.document.getElementById("spnSign");
	if(win.gDefaultSignMode == "0"){
		spnSign.innerText = win.gDefaultSign;
	}else{
		spnSign.innerHTML = win.gDefaultSign;
	}
	// window.frames["HtmlEditor"].focus();
}
function Request(name) {//获取页面ID参数
var reg = new RegExp("(^|\\?|&)"+ name +"=([^&]*)(\\s|&|$)", "i");
if (reg.test(location.href))
return unescape(RegExp.$2.replace(/\+/g, " "));
return "";
}

function LoadContent(ContentID){
	if (typeof(window.frames["HtmlEditor"])=="object"){
		eval("window.frames['HtmlEditor'].document.body.innerHTML=window.parent.document.getElementById('"+ContentID+"').value;");
		eval("setInterval(\"SaveContent('"+ContentID+"')\",500)");
	}else{
		eval("setTimeout(\"LoadContent('"+ContentID+"')\",200)");
	}
}

function SaveContent(ContentID){
	if(sourceEditor.value!=window.frames['HtmlEditor'].document.getElementsByTagName('body')[0].innerHTML){
		if(sourceEditor.style.display=="none"){
		   sourceEditor.value=window.frames['HtmlEditor'].document.getElementsByTagName('body')[0].innerHTML
		   
		}else{
		   window.frames['HtmlEditor'].document.getElementsByTagName('body')[0].innerHTML=sourceEditor.value
		}
	}
	if(eval("window.parent.document.getElementById('"+ContentID+"').value!=window.frames['HtmlEditor'].document.getElementsByTagName('body')[0].innerHTML")){
		eval("window.parent.document.getElementById('"+ContentID+"').value=window.frames['HtmlEditor'].document.getElementsByTagName('body')[0].innerHTML;");
		
	}
}
window.onload = function(){
	try{
		gLoaded = true;
		fSetEditable();
		fSetFrmClick();
		ResetDomain();
		fSetHtmlContent();
		top.frames["jsFrame"].fHideWaiting();
	}catch(e){
		// window.location.reload();
	}
}
function fSetColor(){
	var dvForeColor =$("dvForeColor");
	if(dvForeColor.getElementsByTagName("TABLE").length == 1){
		dvForeColor.innerHTML = drawCube() + dvForeColor.innerHTML;
	}
}
window.onblur =function(){
	return;
	var dvForeColor =$("dvForeColor");
	var dvPortrait =$("dvPortrait");
	dvForeColor.style.display = "none";
	dvPortrait.style.display = "none";
	if(!gIsIE || 1==1){
		fHideMenu();
	}
}
document.onmousemove = function(e){
	if(gIsIE) var el = event.srcElement;
	else var el = e.target;
	var tdView = $("tdView");
	var tdColorCode = $("tdColorCode");
	var dvForeColor =$("dvForeColor");
	var dvPortrait =$("dvPortrait");
	var fontsize =$("fontsize");
	var fontface =$("fontface");
//	if(el.tagName == "IMG"){
//		el.style.borderRight="1px #cccccc solid";
//		el.style.borderBottom="1px #cccccc solid";
//	}else{
//		fSetImgBorder();
//	}
	if(el.tagName == "IMG"){
		try{
			if(fCheckIfColorBoard(el)){
				tdView.bgColor = el.parentNode.bgColor;
				tdColorCode.innerHTML = el.parentNode.bgColor
			}
		}catch(e){}
	}else{
		return;
		dvForeColor.style.display = "none";
		if(!fCheckIfPortraitBoard(el)) dvPortrait.style.display = "none";
		if(!fCheckIfFontFace(el)) fontface.style.display = "none";
		if(!fCheckIfFontSize(el)) fontsize.style.display = "none";
	}
}
document.onclick = function(e){
	if(gIsIE) var el = event.srcElement;
	else var el = e.target;
	var dvForeColor =$("dvForeColor");
	var dvPortrait =$("dvPortrait");

	if(el.tagName == "IMG"){
		try{
			if(fCheckIfColorBoard(el)){
				format(gSetColorType, el.parentNode.bgColor);
				dvForeColor.style.display = "none";
				return;
			}
		}catch(e){}
		try{
			if(fCheckIfPortraitBoard(el)){
				format("InsertImage", el.src);
				dvPortrait.style.display = "none";
				return;
			}
		}catch(e){}
	}
	fHideMenu();
	switch(el.id){
		case "imgFontface":
			var fontface = $("fontface");
			if(fontface) fontface.style.display = "";
			break;
		case "imgFontsize":
			var fontsize = $("fontsize");
			if(fontsize) fontsize.style.display = "";
			break;
		case "imgFontColor":
			var dvForeColor = $("dvForeColor");
			if(dvForeColor) dvForeColor.style.display = "";
			break;
		case "imgBackColor":
			var dvForeColor = $("dvForeColor");
			if(dvForeColor) dvForeColor.style.display = "";
			break;
		case "imgFace":
			var dvPortrait = $("dvPortrait");
			if(dvPortrait) dvPortrait.style.display = "";
			break;
		case "imgAlign":
			var divAlign = $("divAlign");
			if(divAlign) divAlign.style.display = "";
			break;
		case "imgList":
			var divList = $("divList");
			if(divList) divList.style.display = "";
			break;
	}
}
function format(type, para){
	var f = window.frames["HtmlEditor"];
	var sAlert = "";
	if(!gIsIE){
		switch(type){
			case "Cut":
				sAlert = "你的浏览器安全设置不允许编辑器自动执行剪切操作,请使用键盘快捷键(Ctrl+X)来完成";
				break;
			case "Copy":
				sAlert = "你的浏览器安全设置不允许编辑器自动执行拷贝操作,请使用键盘快捷键(Ctrl+C)来完成";
				break;
			case "Paste":
				sAlert = "你的浏览器安全设置不允许编辑器自动执行粘贴操作,请使用键盘快捷键(Ctrl+V)来完成";
				break;
		}
	}
	if(sAlert != ""){
		alert(sAlert);
		return;
	}
	f.focus();
	if(!para)
		if(gIsIE)
			f.document.execCommand(type)
		else
			f.document.execCommand(type,false,false)
	else
		f.document.execCommand(type,false,para)
	f.focus();
}
function setMode(bStatus){
	var sourceEditor = $("sourceEditor");
	var HtmlEditor = $("HtmlEditor");
	var divEditor = $("divEditor");
	var f = window.frames["HtmlEditor"];
	var body = f.document.getElementsByTagName("body")[0];
	if(bStatus){
		sourceEditor.style.display = "";
		HtmlEditor.style.height = "0px";
		divEditor.style.height = "0px";
		sourceEditor.value = body.innerHTML;
	}else{
		sourceEditor.style.display = "none";
		if(gIsIE){
			HtmlEditor.style.height = "286px";
			divEditor.style.height = "286px";
		}else{
			HtmlEditor.style.height = "283px";
			divEditor.style.height = "283px";
		}
		body.innerHTML = sourceEditor.value;
		//fSetEditable();
	}
}
function foreColor(e) {
	fDisplayColorBoard(e);
	gSetColorType = "foreColor";
	/*var sColor = fDisplayColorBoard(e);
	gSetColorType = "foreColor";
	if(gIsIE) format(gSetColorType, sColor);*/
}
function backColor(e){
	var sColor = fDisplayColorBoard(e);
	if(gIsIE)
		gSetColorType = "backcolor";
	else
		gSetColorType = "backcolor";
	// if(gIsIE) format(gSetColorType, sColor);
}
function fDisplayColorBoard(e){
	if(gIsIE){
		var e = window.event;
	}
	if(gIEVer<=5.01 && gIsIE){
		var arr = showModalDialog("ColorSelect.htm", "", "font-family:Verdana; font-size:12; status:no; dialogWidth:21em; dialogHeight:21em");
		if (arr != null) return arr;
		return;
	}
	var dvForeColor =$("dvForeColor");
	fSetColor();
	var iX = e.clientX;
	var iY = e.clientY;
	dvForeColor.style.display = "";
	dvForeColor.style.left = (iX-60) + "px";
	dvForeColor.style.top = 33 + "px";
	return true;
}
function createLink() {
	var sURL=window.prompt("Enter link location (e.g. http://www.abc.com/):", "http://");
	if ((sURL!=null) && (sURL!="http://")){
		format("CreateLink", sURL);
	}
}
function createImg()	{
	var sPhoto=prompt("请输入图片位置:", "http://");
	if ((sPhoto!=null) && (sPhoto!="http://")){
		format("InsertImage", sPhoto);
	}
}
function addPortrait(e){
	if(gIEVer<=5.01 && gIsIE || 1==1){
		// var imgurl = showModalDialog("portraitSelect.htm","", "font-family:Verdana; font-size:12; status:no; unadorned:yes; scroll:no; resizable:yes;dialogWidth:358px; dialogHeight:232px");
		// if (imgurl != null)	format("InsertImage", imgurl);
		var dvPortrait =$("dvPortrait");
		if(dvPortrait){
			dvPortrait.parentNode.removeChild(dvPortrait);
		}
		var div = document.createElement("DIV");
		div.style.position = "absolute";
		div.style.zIndex = "9";
		div.id = "dvPortrait";
		var iX = e.clientX;
		div.style.top = 33 + "px";
		div.style.left = (iX-380) + "px";
		div.innerHTML = '<iframe border=0 marginWidth=0 marginHeight=0 frameBorder=no style="width:358px;height:232px" src="portraitSelect.htm">';
		document.body.appendChild(div);
		var dvPortrait = $("dvPortrait");
		dvPortrait.style.display = "";
		return;
	}
	var dvPortrait =$("dvPortrait");
	var tbPortrait = $("tbPortrait");
	var iX = e.clientX;
	var iY = e.clientY;
	dvPortrait.style.display = "";
	if(window.screen.width == 1024){
		dvPortrait.style.left = (iX-380) + "px";
	}else{
		if(gIsIE)
			dvPortrait.style.left = (iX-380) + "px";
		else
			dvPortrait.style.left = (iX-380) + "px";
	}
	dvPortrait.style.top = 33 + "px";
	dvPortrait.innerHTML = '<table width="100%" border="0" cellpadding="5" cellspacing="1" style="cursor:hand" bgcolor="black" ID="tbPortrait"><tr align="left" bgcolor="#f8f8f8" class="unnamed1" align="center" ID="trContent">'+ drawPortrats() +'</tr>	</table>';
}
function fCheckIfColorBoard(obj){
	if(obj.parentNode){
		if(obj.parentNode.id == "dvForeColor") return true;
		else return fCheckIfColorBoard(obj.parentNode);
	}else{
		return false;
	}
}
function fCheckIfPortraitBoard(obj){
	if(obj.parentNode){
		if(obj.parentNode.id == "dvPortrait") return true;
		else return fCheckIfPortraitBoard(obj.parentNode);
	}else{
		return false;
	}
}
function fCheckIfFontFace(obj){
	if(obj.parentNode){
		if(obj.parentNode.id == "fontface") return true;
		else return fCheckIfFontFace(obj.parentNode);
	}else{
		return false;
	}
}
function fCheckIfFontSize(obj){
	if(obj.parentNode){
		if(obj.parentNode.id == "fontsize") return true;
		else return fCheckIfFontSize(obj.parentNode);
	}else{
		return false;
	}
}
function fImgOver(el){
	if(el.tagName == "IMG"){
		el.style.borderRight="1px #cccccc solid";
		el.style.borderBottom="1px #cccccc solid";
	}
}
function fImgMoveOut(el){
	if(el.tagName == "IMG"){
		el.style.borderRight="1px #F3F8FC solid";
		el.style.borderBottom="1px #F3F8FC solid";
	}
}
String.prototype.trim = function(){
	return this.replace(/(^\s*)|(\s*$)/g, "");
}
function fSetBorderMouseOver(obj) {
	obj.style.borderRight="1px solid #aaa";
	obj.style.borderBottom="1px solid #aaa";
	obj.style.borderTop="1px solid #fff";
	obj.style.borderLeft="1px solid #fff";
	/*var sd = document.getElementsByTagName("div");
	for(i=0;i<sd.length;i++) {
		sd[i].style.display = "none";
	}*/
} 

function fSetBorderMouseOut(obj) {
	obj.style.border="none";
}

function fSetBorderMouseDown(obj) {
	obj.style.borderRight="1px #F3F8FC solid";
	obj.style.borderBottom="1px #F3F8FC solid";
	obj.style.borderTop="1px #cccccc solid";
	obj.style.borderLeft="1px #cccccc solid";
}

function fDisplayElement(element,displayValue) {
	if(gIEVer<=5.01 && gIsIE){
		if(element == "fontface"){
			var sReturnValue = showModalDialog("FontFaceSelect.htm","", "font-family:Verdana; font-size:12; status:no; unadorned:yes; scroll:no; resizable:yes;dialogWidth:112px; dialogHeight:271px");;
			format("fontname",sReturnValue);
		}else if(element == "fontsize"){
			var sReturnValue = showModalDialog("FontSizeSelect.htm","", "font-family:Verdana; font-size:12; status:no; unadorned:yes; scroll:no; resizable:yes;dialogWidth:130px; dialogHeight:250px");;
			format("fontsize",sReturnValue);
		}else if(element == "divAlign"){
			var sReturnValue = showModalDialog("AlignSelect.htm","", "font-family:Verdana; font-size:12; status:no; unadorned:yes; scroll:no; resizable:yes;dialogWidth:40px; dialogHeight:45px");;
			format(sReturnValue);
		}else if(element == "divList"){
			var sReturnValue = showModalDialog("ListSelect.htm","", "font-family:Verdana; font-size:12; status:no; unadorned:yes; scroll:no; resizable:yes;dialogWidth:60px; dialogHeight:45px");;
			format(sReturnValue);
		}
		return;
	}
	fHideMenu();
	if ( typeof element == "string" )
		element = $(element);
	if (element == null) return;
	element.style.display = displayValue;
	if(gIsIE){
		var e = event;
	}else{
		var e = ev;
	}
	var iX = e.clientX;
	var iY = e.clientY;
	element.style.display = "";
	element.style.left = (iX-30) + "px";
	element.style.top = 33 + "px";
	return true;
}
function fSetModeTip(obj){
	var x = f_GetX(obj);
	var y = f_GetY(obj);
	var dvModeTip = $("dvModeTip");
	if(!dvModeTip){
		var dv = document.createElement("DIV");
		dv.style.position = "absolute";
		dv.style.top = 33 + "px";
		dv.style.left = (x-40) + "px";
		dv.style.zIndex = "999";
		dv.style.fontSize = "12px";
		dv.id = "dvModeTip";
		dv.style.padding = "2 2 0 2px";
		dv.style.border = "1px #000000 solid";
		dv.style.backgroundColor = "#FFFFCC";
		dv.style.height = "12px";
		dv.innerHTML = "编辑源码";
		document.body.appendChild(dv);
	}else{
		dvModeTip.style.display = "";
	}
}
function fHideTip(){
	$("dvModeTip").style.display = "none";
}
function f_GetX(e)
{
	var l=e.offsetLeft;
	while(e=e.offsetParent){				
		l+=e.offsetLeft;
	}
	return l;
}
function f_GetY(e)
{
	var t=e.offsetTop;
	while(e=e.offsetParent){
		t+=e.offsetTop;
	}
	return t;
}
function fHideMenu(){
	var fontface = $("fontface");
	var fontsize = $("fontsize");
	var dvForeColor =$("dvForeColor");
	var dvPortrait =$("dvPortrait");
	var divAlign =$("divAlign");
	var divList =$("divList");
	if(dvForeColor) dvForeColor.style.display = "none";
	if(dvPortrait) dvPortrait.style.display = "none";
	if(fontface) fontface.style.display = "none";
	if(fontsize) fontsize.style.display = "none";
	if(divAlign) divAlign.style.display = "none";
	if(divList) divList.style.display = "none";
}
function $(id){
	return document.getElementById(id);
}
window.onerror = function(){
	return true;
}
function fGetList(){

}
function fGetAlign(){
	
}
function fHide(obj){
	obj.style.display="none";
}

</SCRIPT>
</head>

<body>
<table width="100%"  border="0" cellpadding="0" cellspacing="0" background="images/bg.gif" style="border:1px solid #c5c5c5; ">
  <tr>
    <td height="31" style="padding-left:5px; "><table border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td class="ico">
		<div class="icons icoCut" ><img border="0" width="100%" height="100%" src="images/place.gif" onclick="format('Cut')" title="剪切"
onmousedown=fSetBorderMouseDown(this)  
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>			</td>
        <td class="ico">
		<div class="icons icoCpy" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Copy')" title="复制"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoPse" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Paste')" title="粘贴"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico" style="width:12px"><img src="images/line.gif" width="4" height="20" style="margin-left:2px "  /></td>
        <td class="ico2">
		<div class="icons icoFfm" style="width:25px"  ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this)  id="imgFontface" title="字体" onClick="fGetEv(event);fDisplayElement('fontface','')"  
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico2">
		<div class="icons icoFsz" style="width:25px" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) id="imgFontsize" title="字号" onClick="fGetEv(event);fDisplayElement('fontsize','')"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoWgt" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Bold');" title="加粗"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoIta" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Italic');" title="斜体"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoUln" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Underline')" title="下划线"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this) ></div>		</td>
		
        <td class="ico3">
		<div class="icons icoFcl"  ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) title="字体颜色"
            onmouseover=fSetBorderMouseOver(this)  onclick="foreColor(event)" id="imgFontColor"
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico2">
		<div class="icons icoBcl"  ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) title="背景颜色"
            onmouseover=fSetBorderMouseOver(this)  onclick="backColor(event)" id="imgBackColor"
            onmouseout=fSetBorderMouseOut(this)></div>		</td>		
        <td class="ico">
		<div class="icons icoAgn"><img border="0" width="100%" height="100%"  onmousedown=fSetBorderMouseDown(this) id="imgAlign" onClick="fGetEv(event);fDisplayElement('divAlign','')" title="对齐"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this) src="images/place.gif"></div>		</td>
        <td class="ico">
		<div class="icons icoLst" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) id="imgList" onClick="fGetEv(event);fDisplayElement('divList','')"title="编号"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoOdt" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Outdent')" title="减少缩进"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico">
		<div class="icons icoIdt" ><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="format('Indent')" title="增加缩进"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
        <td class="ico" style="width:12px"><img src="images/line.gif" width="4" height="20" style="margin-left:2px "  /></td>

        <td class="ico">
		<div class="icons icoUrl"><img border="0" width="100%" height="100%" src="images/place.gif" onmousedown=fSetBorderMouseDown(this) onclick="createLink()" title="超链接"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>		</td>
		
       <td class="ico">
		<div class="icons icoImg"><img border="0" width="100%" height="100%" src="images/place.gif"  onmousedown=fSetBorderMouseDown(this) onclick="createImg()" title="增加图片" 
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this)></div>
		</td>
		
        <td class="ico3">
		<div class="icons icoMfc"><img border="0" width="100%" height="100%" src="images/place.gif"  onmousedown=fSetBorderMouseDown(this) onclick="addPortrait(event)" title="魔法表情" id="imgFace"
            onmouseover=fSetBorderMouseOver(this) 
            onmouseout=fSetBorderMouseOut(this) /></div>		</td>
		<td class="ico4"><img src="images/line.gif" width="4" height="20" style="margin-left:5px "  /></td>
		<td style="font-size:12px"> <input type=checkbox name="switchMode" LANGUAGE="javascript" onclick="setMode(this.checked)" onmouseout="fHideTip()" onmouseover="fSetModeTip(this)"></td>
        </tr>
    </table></td>
  </tr>
</table>
<div style="width:100px;height:100px;position:absolute;display:none;top:-500px;left:-500px" ID="dvForeColor">
<TABLE CELLPADDING=0 CELLSPACING=0 style="border:1px #888888 solid" width="218" height="25">
</TABLE>
</div>
<div style="width:100px;height:100px;position:absolute;display:none;top:-500px;left:-500px" ID="dvPortrait"></div>
<div id="fontface" style="z-index:99; padding:1px; display:none; position:absolute; top:35px; left:2px; background:#FFFFFF; border:1px solid #838383; width:110px; height:270px;"><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px '宋体';">宋体</a><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px '黑体';">黑体</a><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px '楷体';">楷体</a><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px '隶书';">隶书</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px '幼圆';">幼圆</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px Arial;">Arial</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px 'Arial Narrow';">Arial Narrow</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px 'Arial Black';">Arial Black</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px 'Comic Sans MS';">Comic Sans MS</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px Courier;">Courier</a><a href="###" onClick="fontname(this)" class="n" style="font:normal 12px System;">System</a><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px 'Times New Roman';">Times New Roman</a><a href="javascript:void(0)" onClick="fontname(this)" class="n" style="font:normal 12px Verdana;">Verdana</a></div>
<div id="fontsize" style="padding:1px; display:none; position:absolute; top:35px; left:26px; background:#FFFFFF; border:1px solid #838383; width:115px; height:160px;"><a href="javascript:void(0)" onClick="fontsize(1,this)" class="n" style="font-size:xx-small;line-height:120%;">极小</a><a href="javascript:void(0)" onClick="fontsize(2,this)" class="n" style="font-size:x-small;line-height:120%;">特小</a><a href="javascript:void(0)" onClick="fontsize(3,this)" class="n" style="font-size:small;line-height:120%;">小</a><a href="#" onClick="fontsize(4,this)" class="n" style="font-size:medium;line-height:120%;">中</a><a href="javascript:void(0)" onClick="fontsize(5,this)" class="n" style="font-size:large;line-height:120%;">大</a><a href="javascript:void(0)" onClick="fontsize(6,this)" class="n" style="font-size:x-large;line-height:120%;">特大</a><a href="javascript:void(0)" onClick="fontsize(7,this)" class="n" style="font-size:xx-large;line-height:140%;">极大</a></div>
<div id="divList" style="padding:1px; display:none; position:absolute; top:35px; left:26px; background:#FFFFFF; border:1px solid #838383; width:60px; height:40px;"><a href="javascript:void(0)" onClick="format('Insertorderedlist');fHide(this.parentNode)" class="n">数字列表</a><a href="javascript:void(0)" onClick="format('Insertunorderedlist');fHide(this.parentNode)" class="n">符号列表</a></div>	
<div id="divAlign" style="padding:1px; display:none; position:absolute; top:35px; left:26px; background:#FFFFFF; border:1px solid #838383; width:60px; height:60px;"><a href="javascript:void(0)" onClick="format('Justifyleft');fHide(this.parentNode)" class="n">左对齐</a><a href="javascript:void(0)" onClick="format('Justifycenter');fHide(this.parentNode)" class="n">居中对齐</a><a href="javascript:void(0)" onClick="format('Justifyright');fHide(this.parentNode)" class="n">右对齐</a></div>	
<div id="divEditor">
<SCRIPT LANGUAGE="JavaScript">
<!--
if(document.all){
	document.write('<table width="100%" height:287px border="0" cellspacing="0" cellpadding="0" ><tr><td style="border:1px solid #C5C5C5; border-top:0;"><IFRAME class="HtmlEditor" ID="HtmlEditor" name="HtmlEditor" style=" height:286px;width:100%" frameBorder="0" marginHeight=0 marginWidth=0 src="blankpage.htm"></IFRAME></td></tr></table>');
}else{
	document.write('<table width="100%" height:288px border="0" cellspacing="0" cellpadding="0" ><tr><td style="border:1px solid #C5C5C5; border-top:0;background-color:#ffffff"><IFRAME class="HtmlEditor" ID="HtmlEditor" name="HtmlEditor" style=" height:283px;width:100%;margin-left:1px;margin-bottom:1px;" frameBorder="0" marginHeight=0 marginWidth=0 src="blankpage.htm"></IFRAME></td></tr></table>');
}
//-->
</SCRIPT>
</div>
<SCRIPT LANGUAGE="JavaScript">
<!--
if(document.all){
	document.write('<textarea ID="sourceEditor" style="height:280px;width:100%;display:none">');
}else{
	document.write('<textarea ID="sourceEditor" style="height:282px;width:100%;display:none">');
}

//-->
</SCRIPT>
</body>
</html>

