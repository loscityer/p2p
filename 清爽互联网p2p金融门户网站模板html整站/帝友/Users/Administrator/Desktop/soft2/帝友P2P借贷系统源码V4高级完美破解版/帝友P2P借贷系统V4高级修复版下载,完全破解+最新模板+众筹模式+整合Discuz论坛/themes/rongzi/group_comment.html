{if $magic.request.type=="edit"}
{articles module="group" function="GetGroupCommentsOne" id='$magic.request.pid'}
<form id="login-form" action="/?user&q=code/group/comment&group_id={$magic.request.group_id}&type={$magic.request.type}&cid={$magic.request.pid}&id={$magic.request.id}" method="post">
<p><label>评论内容：<textarea id="group_comment_content" name="contents" cols="60" rows="6" >{$var.contents}</textarea></label></p>
</form>
{elseif $magic.request.type=="editarticle"}
{articles module="group" function="GetGroupArticlesOne" id='$magic.request.id' var="Avar"}
<form id="login-form" action="/?user&q=code/group/articles&articles_id={$magic.request.id}" method="post">
<p><label>编辑话题：<textarea id="group_comment_content" name="contents" cols="60" rows="6" >{$Avar.contents}</textarea></label></p>
</form>
{/articles}
{else}
<form id="login-form" action="/?user&q=code/group/comment&group_id={$magic.request.group_id}&type={$magic.request.type}&pid={$magic.request.pid}&tid={$magic.request.tid}&id={$magic.request.id}" method="post">
<p><label>评论内容：<textarea id="group_comment_content" name="contents" cols="60" rows="6" ></textarea></label></p>
</form>
{/if}
<!-- IE8 style 标签写在HTML片段下方才能生效 -->
{literal}
<style>
#login-form p { padding:5px;  }
#login-form input { width:15em; padding:4px; border:1px solid #CCC; }
#login-form input:focus { border-color:#426DC9; }
#login-form .login-form-error { background:#FFFBFC; border-color:#F00 !important; }
</style>
<!--
	1、 标准script的标签将会被执行，这里要注意此处定义的变量会污染全局
    2、 本页编码要与对话框所在页面编码保持一致
-->
<script type="text/javascript">

{/literal}
var type='{$magic.request.type}';
{literal}
var api = lhgdialog.focus, //返回当前最顶层窗口实例对象
	$$ = function(id){return document.getElementById(id)},
	form = $$('login-form'),
	username = $$('group_comment_content'),
	password = $$('login-form-password');

if (type==''){

// 操作对话框
api.title('加入圈子')
	// 自定义按钮
	.button(
		{
			name: '加入',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else if (type=="editarticle"){
	// 操作对话框
	api.title('编辑话题')
	// 自定义按钮
	.button(
		{
			name: '编辑',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else if (type=="reply"){
	// 操作对话框
	api.title('评论回复')
	// 自定义按钮
	.button(
		{
			name: '回复',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else if (type=="edit"){
	// 操作对话框
	api.title('编辑评论')
	// 自定义按钮
	.button(
		{
			name: '修改',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else if (type=="admin_yes" ){
	// 操作对话框
	api.title('设为管理员')
	// 自定义按钮
	.button(
		{
			name: '设为管理员',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else if (type=="admin_no" ){
	// 操作对话框
	api.title('撤销管理员')
	// 自定义按钮
	.button(
		{
			name: '撤销管理员',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}else{
	// 操作对话框
	api.title('审核成员')
	// 自定义按钮
	.button(
		{
			name: '拒绝加入',
			callback: function(){
				if (check(username)) form.submit();
				return false;
			},
			focus: true
		},
		{
			name: '取消'
		}
		/*, 更多按钮.. */
	)
	// 锁屏
	.lock();
}
username.focus();

// 表单验证
var check = function (input) {
	if (input.value === '') {
		inputError(input);
		input.focus();
		return false;
	} else {
		return true;
	};
};

// 输入错误提示
var inputError = function (input) {
	clearTimeout(inputError.timer);
	var num = 0;
	var fn = function () {
		inputError.timer = setTimeout(function () {
			input.className = input.className === '' ? 'login-form-error' : '';
			if (num === 5) {
				input.className === '';
			} else {
				fn(num ++);
			};
		}, 150);
	};
	fn();
};
</script>
{/literal}